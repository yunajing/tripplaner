
<!DOCTYPE html>
<!-- saved from url=(0050)http://getbootstrap.com/examples/navbar-fixed-top/ -->
<html lang="en" version="g42dymwpi--nx">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="">
<meta name="author" content="yj2270">

<title>Trip Planer</title>

<!-- Bootstrap core CSS -->
<link href="./styles/bootstrap.css" rel="stylesheet">

<!-- Custom styles for this template -->
<link href="./styles/navbar-fixed-top.css" rel="stylesheet">
<link href="./styles/user_style.css" rel="stylesheet">
<link href="./styles/style.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="./styles/jquery-ui.css">
<link href="./styles/explorepage.css" type="text/css" rel="stylesheet">
<script src="./script/script.js"></script>
<script src="./script/filer.js"></script>
<script src="./script/jquery-1.10.2.min.js"></script>
<script type="text/javascript"></script>
<link href="./styles/leaflet.css" type="text/css" rel="stylesheet" />
<link href="./styles/apisamples.css" type="text/css" rel="stylesheet" />
<script src="http://code.jquery.com/jquery-1.9.1.js"></script>
<script src="http://code.jquery.com/ui/1.10.3/jquery-ui.js"></script>
<script src="./script/apisamples.js" type="text/javascript"></script>
<script src="./script/third_party/jquery.ba-bbq.js"
	type="text/javascript"></script>
<script src="./script/third_party/leaflet.js" type="text/javascript"></script>
<script src="./script/third_party/wax.leaf.min.js"
	type="text/javascript"></script>
<style>
    body { font-size: 62.5%; }
    label, input { display:block; }
    input.text { margin-bottom:12px; width:95%; padding: .4em; }
    fieldset { padding:0; border:0; margin-top:25px; }
    h1 { font-size: 12px; margin: .6em 0; }
    div#users-contain { width: 350px; margin: 20px 0; }
    div#users-contain table { margin: 1em 0; border-collapse: collapse; width: 100%; }
    div#users-contain table td, div#users-contain table th { border: 1px solid #eee; padding: .6em 10px; text-align: left; }
    .ui-dialog .ui-state-error { padding: .3em; }
    .validateTips { border: 1px solid transparent; padding: 0.3em; }
  </style>
<script>
  var clone;
  var vid;
  var tabCounter=0;
  $(function() {
    $( "#delete" ).droppable({
      drop: function( event, ui ) {
        deleteItem(ui.draggable);
      }
    });
  });
  function deleteItem( $item ) {
      $item.fadeOut();
      var itemid = $item.attr('id');
      if (itemid.substr(0,3)=="tag"){
      	var panelId = $item.remove().attr("aria-controls");
      	console.log(panelId);
      	$( "#" + panelId ).remove();
      	$("#tabs").tabs( "refresh" );
      }
    }

  $(function() {
    var tabTitle = $( "#tab_title" );
      tabDate = $( "#tab_date" );
      tabTemplate = "<li><a href='#{href}'>#{label}</a> <span class='ui-icon ui-icon-close' role='presentation'>Remove Tab</span></li>";
 
    // modal dialog init: custom buttons and a "close" callback reseting the form inside
    var dialog = $( "#createCalendar" ).dialog({
      autoOpen: false,
      modal: true,
      buttons: {
        Add: function() {
          addTab();
          $( this ).dialog( "close" );
        },
        Cancel: function() {
          $( this ).dialog( "close" );
        }
      },
      close: function() {
        form[ 0 ].reset();
      }
    });
 
    // addTab form: calls addTab function on submit and closes the dialog
    var form = dialog.find( "form" ).submit(function( event ) {
      addTab();
      dialog.dialog( "close" );
      event.preventDefault();
    });
 
    // actual addTab function: adds new tab using the input from the form above
    function addTab() {
    	tabCounter+=1;
      	var label = tabTitle.val() || "Tab " + tabCounter,
      	id = "tag-" + tabCounter;
      	$('#schedule').append(
							'<li id="'+id+'"class="ui-state-default ui-corner-left" role="tab" tabindex="-1" aria-controls="tab-'+tabCounter+'" aria-labelledby="ui-id-" aria-selected=""><a href="#tabs-'+tabCounter+'">'+label+'</a></li>');
      	$("li",$("#schedule")).draggable({
				cancel: "a.ui-icon", // clicking an icon won't initiate dragging
      			revert: "invalid", // when not dropped, the item will revert back to its initial position
      			containment: "document",
      			helper: "clone",
      			cursor: "move"
		});
        var tabid = "tabs-" + tabCounter;
        console.log(tabid);
		$("#tabs").append('<div id="tabs-'+tabCounter+'"><table id="table'+tabCounter+'">');
			for (i = 0; i < 23; i++) {
				var start = 0 + i;
				var end = 1 + i;
				$('#table' + tabCounter)
						.append(
								'<tr><td>'
										+ start
										+ ':00 to '
										+ end
										+ ':00'
										+ '</td><td><div id="'+tabid+'div'
										+ i
										+ '" class = "drag_div"></div></td></tr>');
				var $dropdiv = $("#"+tabid+"div"+i); 
				$dropdiv.droppable(
					{
						accept: "div",
      					drop: function( event, ui ) {
        					if ($(this).innerHTML == null || $(this).innerHTML == ''){
        						var draggedid = $(ui.draggable).attr('id');
        						var element = document.getElementById(draggedid).getElementsByTagName("a").item(0)
        						clone = element.cloneNode();
								console.log($(this).attr('id'));
								vid= $(this).attr('id');
								console.log(vid);
								$( "#dialog-form" ).dialog( "open" );
								$( "#calenderName").html('<p id= "calenderName" class="validateTips">Adding to Schedule:'+vid.substr(0,vid.length-4)+'</p>');
								document.getElementById('body').style.overflow="hidden";
        					}
      				}
    			}
				)
			}
			$("#tabs").append('</table></div>');
      		$("#tabs").tabs( "refresh" );
    }
 
    // addTab button: just opens the dialog
    $( "#create" )
      .button()
      .click(function() {
        dialog.dialog( "open" );
      });
 	$( "#submit" )
      .button()
      .click(function() {
        place = $("#place");
        placeVal = place.val() || "Chicago,IL";
        var keyword = $("#keyword").val() || "High";
        console.log(placeVal+" "+keyword);
        search(placeVal,keyword);
      });
    $( "#save" )
      .button()
      .click(function() {
        tabs = $("#tabs");
        var panelId = tabs.find(".ui-tabs-active").attr("aria-controls");
        console.log(document.getElementById(panelId).innerHTML);
        localStorage.setItem('tabs',document.getElementById(panelId).innerHTML);
      });
  });
  $(function() {
    //var date = $( "#datepicker"),
      fromTime = $( "#fromTime" ),
      toTime = $( "#toTime" ),
      comment = $("#comment"),
      allFields = $( [] ).add( fromTime).add( toTime).add( comment ),
      tips = $( ".validateTips" );
 
    $( "#dialog-form" ).position({
        at: "center center",
    });

 
    $( "#dialog-form" ).dialog({
      autoOpen: false,
      height: 300,
      width: 350,
      modal: true,
      buttons: {
        "Add to Calender": function() {
        	$("#"+vid).append('<div id="delete-'+vid+'"></div>');
        	$("#delete-"+vid).append(clone);
        	$("#delete-"+vid).append("<p>"+comment.val()+"</p>");
        	$("#delete-"+vid).draggable({
      			cancel: "a.ui-icon", // clicking an icon won't initiate dragging
      			revert: "invalid", // when not dropped, the item will revert back to its initial position
      			containment: "document",
      			helper: "clone",
      			cursor: "move"
    		});
        	//$("#"+vid).append('<div id="delete-'+vid+'"draggable="true" ondragstart="drag(event)">'+clone+'</div>');
        	allFields.val( "" ).removeClass( "ui-state-error" );
        	$( this ).dialog( "close" );
        	document.getElementById('body').style.overflow="scroll";
        },
        Cancel: function() {
          $( this ).dialog( "close" );
          document.getElementById('body').style.overflow="scroll";
        }
      },
      close: function() {
        allFields.val( "" ).removeClass( "ui-state-error" );
        document.getElementById('body').style.overflow="scroll";
      }
    });
  });
	var scrollHandler = function(){
		myScroll = $(window).scrollTop();
  		$('#result').html(myScroll);
	};

	var config = {
		apiKey : 'NFAOLYM5EJBOO4RB11JLRMNZNH0ZHQTY0X3KMBYRYUALUPOS',
		apisecret : 'FAAFWOOSW3OB44DEUKWZF2KDTAI3ODHAEKSJ5MCRZWPERCQL',
		authUrl : 'https://foursquare.com/',
		apiUrl : 'https://api.foursquare.com/'
	};
	function search(place, keyword) {
		$.getJSON(config.apiUrl + 'v2/venues/explore?near=' + place
								+ '&query=' + keyword + '&client_id='
								+ config.apiKey + '&client_secret='
								+ config.apisecret,
						{},
						function(data) {
							venues = data['response']['groups'][0]['items'];
							console.log(document.getElementById("results"));
							if (document.getElementById("results")==null) {
								$('#container').append(
									'<table id="results" class="search_result">');
							}
							/* Place marker for each venue. */
							
							else {$('#results').html("");}
							for (var i = 0; i < venues.length; i++) {
								var name = venues[i]['venue']['name'];
								var url = "https://foursquare.com/v/" + name
										+ "/" + venues[i]['venue']['id'];
								var address = venues[i]['venue']['location']['address']
										+ "("
										+ venues[i]['venue']['location']['crossStreet']
										+ ")";
								var price = ";"
								if (venues[i]['venue']['price']){
									var dollars = venues[i]['venue']['price']['tier'];
									price = '<span class="venueDataItem"><span class="price" title=""><span class="darken" itemprop="priceRange">';
									for (k=0;k<dollars;k++){
										price+='$';
									}
									price+='</span></span>'
								}
								else price = '<span class="venueDataItem"><span class="price" title=""><span class="darken" itemprop="priceRange">undefined</span></span>';
								var venueName = '<div class="venueName"><a href="'+url+'" target="_blank">'+name+'</a></div><span class="venueScore positive" title="">'+venues[i]['venue']['rating']+'</span>';
								var address = '<div class="venueAddress">'+address+'</div>';
								
								
								var resultblock= '<tr><td><div class="venueBlock" id="drag-'+ i+ '">'
														+'<div class="venueDetails">'
														+venueName+'<div class="venueAddressData">'
														+address
														+'<div class="venueData">'+price+'</div></div></div><div style="clear:both"></div></td></tr>';
								$('#results').append(resultblock);
								$("#drag-"+i).draggable({
									cancel: "a.ui-icon", // clicking an icon won't initiate dragging
					      			revert: "invalid", // when not dropped, the item will revert back to its initial position
					      			containment: "document",
					      			helper: "clone",
					      			cursor: "move"
								});
							}
							$('#container').append('</table>');
						})
	}
	function onLoadEvent() {
		$("#solidcover").hide();
		$("#cover").hide();
		var place = 'Chicago,IL';
		var keyword = 'high end';
		console.log(config.apiUrl + 'v2/venues/explore?near=' + place
				+ '&query=' + keyword + '&client_id='
				+ config.apiKey + '&client_secret='
				+ config.apisecret);

		//search(place, keyword);
		// for (i = 1; i < 4; i++) {
		// 	$('#schedule')
		// 			.append(
		// 					'<li id="tag-'+i+'"class="ui-state-default ui-corner-left" role="tab" tabindex="-1" aria-controls="tab-'+i+'" aria-labelledby="ui-id-" aria-selected=""><a href="#tabs-'+i+'">calender'
		// 							+ i + '</a></li>');
		// }
		// $("li",$("#schedule")).draggable({
		// 		cancel: "a.ui-icon", // clicking an icon won't initiate dragging
  //     			revert: "invalid", // when not dropped, the item will revert back to its initial position
  //     			containment: "document",
  //     			helper: "clone",
  //     			cursor: "move"
		// });
		// for (j = 1; j < 4; j++) {
		// 	tabCounter+=1;
		// 	var tabid = "tabs-" + j;
		// 	$("#tabs").append('<div id="tabs-'+j+'"><table id="table'+j+'">');
		// 	for (i = 0; i < 23; i++) {
		// 		var start = 0 + i;
		// 		var end = 1 + i;
		// 		$('#table' + j)
		// 				.append(
		// 						'<tr><td>'
		// 								+ start
		// 								+ ':00 to '
		// 								+ end
		// 								+ ':00'
		// 								+ '</td><td><div id="'+tabid+'div'
		// 								+ i
		// 								+ '" class = "drag_div"></div></td></tr>');
		// 		var $dropdiv = $("#"+tabid+"div"+i); 
		// 		$dropdiv.droppable(
		// 			{
		// 				accept: "div",
  //     					drop: function( event, ui ) {
  //       					if ($(this).innerHTML == null || $(this).innerHTML == ''){
  //       						var draggedid = $(ui.draggable).attr('id');
  //       						var element = document.getElementById(draggedid).getElementsByTagName("a").item(0)
  //       						clone = element.cloneNode();
		// 						console.log($(this).attr('id'));
		// 						vid= $(this).attr('id');
		// 						console.log(vid);
		// 						$( "#dialog-form" ).dialog( "open" );
		// 						$( "#calenderName").html('<p id= "calenderName" class="validateTips">Adding to Schedule:'+vid.substr(0,vid.length-4)+'</p>');
		// 						document.getElementById('body').style.overflow="hidden";
  //       					}
  //     				}
  //   			}
		// 		)
		// 	}
		// 	$("#tabs").append('</table></div>');
		// }
		$("#tabs").tabs().addClass("ui-tabs-vertical ui-helper-clearfix");
		$("#tabs li").removeClass("ui-corner-top").addClass("ui-corner-left");
	}
</script>
</head>

<body id="body" onload="onLoadEvent()">
	<!-- Fixed navbar -->
	  <div id="dialog-form" title="Create new user">
  		<div id="calenderName"></div> 
  		<form>
		  <fieldset>
		    <label for="name">From:</label>
		    <input type="text" name="fromTime" id="fromTime" class="text ui-widget-content ui-corner-all">
		    <label for="email">To:</label>
		    <input type="text" name="toTime" id="email" value="" class="text ui-widget-content ui-corner-all">
		    <label for="password">Comments:</label>
		    <input type="text" name="comment" id="comment" value="" class="text ui-widget-content ui-corner-all">
		  </fieldset>
		</form>
	  </div>
	  <div id="createCalendar" title="Tab data">
		  <form>
		    <fieldset class="ui-helper-reset">
		      <label for="tab_title">Title</label>
		      <input type="text" name="tab_title" id="tab_title" value="" class="ui-widget-content ui-corner-all">
		      <label for="tab_date">Date</label>
		      <textarea name="tab_content" id="tab_content" class="ui-widget-content ui-corner-all"></textarea>
		    </fieldset>
		  </form>
	   </div>
	<div class="navbar navbar-default navbar-fixed-top" role="navigation">
		<div class="container">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle" data-toggle="collapse"
					data-target=".navbar-collapse">
					<span class="sr-only">Toggle navigation</span> <span
						class="icon-bar"></span> <span class="icon-bar"></span> <span
						class="icon-bar"></span>
				</button>
				<a class="navbar-brand" href="ui_project.html">Trip Planer</a>
			</div>
			<div class="navbar-collapse collapse">
				<ul class="nav navbar-nav">
					<li id="schedules" class="dropdown"></li>
				</ul>
			</div>
		</div>
		<!--/.nav-collapse -->
	</div>
	<!-- Main component for a primary marketing message or call to action -->
	<div id="container" class="jumbotron">
		<form style="font-size:20px">
        <fieldset class="ui-helper-reset">
          <label for="tab_title">Place</label>
          <input type="text" name="place" id="place" value="" class="ui-widget-content ui-corner-all">
          <label for="tab_date" >Key word</label>
          <input name="tab_content" id="keyword" class="ui-widget-content ui-corner-all"></intput>
        </fieldset>
    	</form>
    	 <button id="submit" class="btn btn-default">search</button>
		<div id="tabs">
			<ul id="schedule" class="btn-group-vertical" style="float: left;">
			</ul>
		</div>
		<div class="btn-group" style="position:fixed;top:90%;right:10%;">
			<button id="save" type="button" class="btn btn-default">Save</button>
  			<button id="create" type="button" class="btn btn-default">Create Schedule</button>
  			<button id="delete" type="button" class="btn btn-default">Delete</button>
		</div>
		<!-- <table id="results" class="search_result"></table> -->

		<div style="clear: both"></div>
	</div>



	<!-- Bootstrap core JavaScript
	    ================================================== -->
	<!-- Placed at the end of the document so the pages load faster -->
	<script src="./script/bootstrap.min.js"></script>
</body>
</html>